<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Configure AWS STS Credentials :: Bastion Host Setup for AWS OpenShift STS</title>
    <link rel="prev" href="install-openshift-aws-tools.html">
    <link rel="next" href="prepare-install-directory.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Bastion Host Setup for AWS OpenShift STS</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rcb-adoption-1" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Bastion Host Setup for AWS OpenShift STS</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="bastion-host-setup-for-aws-openshift-sts.html">Bastion Host Setup for AWS OpenShift STS</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="environment-setup.html">Environment Setup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="install-required-packages.html">Install Required Packages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configure-vnc-server.html">Configure VNC Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="install-openshift-aws-tools.html">Install OpenShift &amp; AWS Tools</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="configure-aws-sts-credentials.html">Configure AWS STS Credentials</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="prepare-install-directory.html">Prepare Install Directory</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="optional---deploy-or-destroy-cluster.html">Optional - Deploy or Destroy Cluster</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Bastion Host Setup for AWS OpenShift STS</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Bastion Host Setup for AWS OpenShift STS</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="bastion-host-setup-for-aws-openshift-sts.html">Bastion Host Setup for AWS OpenShift STS</a></li>
    <li><a href="configure-aws-sts-credentials.html">Configure AWS STS Credentials</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Configure AWS STS Credentials</h1>
<div class="sect1">
<h2 id="_configure_aws_sts_credentials"><a class="anchor" href="#_configure_aws_sts_credentials"></a>Configure AWS STS Credentials</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_6_configure_aws_sts_credentials"><a class="anchor" href="#_6_configure_aws_sts_credentials"></a>6. Configure AWS STS Credentials</h3>
<div class="paragraph">
<p>This section guides you through creating AWS Security Token Service (STS) IAM roles and credential manifests using the <code>ccoctl</code> tool.</p>
</div>
</div>
<div class="sect2">
<h3 id="_6_1_objective"><a class="anchor" href="#_6_1_objective"></a>6.1. Objective</h3>
<div class="paragraph">
<p>The primary objective of this step is to create AWS STS IAM roles and credential manifests using <code>ccoctl</code>. This process is crucial for establishing secure communication between your OpenShift cluster and AWS services.</p>
</div>
</div>
<div class="sect2">
<h3 id="_6_2_steps"><a class="anchor" href="#_6_2_steps"></a>6.2. Steps</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Create Working Directory</strong></p>
<div class="literalblock">
<div class="content">
<pre>Begin by creating a working directory for the STS configuration:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```bash
cd /home/ec2-user
mkdir -p sts
cd sts
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Delete Existing STS Configuration</strong></p>
<div class="literalblock">
<div class="content">
<pre>Remove any existing STS configurations to ensure a clean setup. Ignore errors if no configurations are found:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```bash
ccoctl aws delete --name ${STS_SUFFIX} --region ${AWS_REGION}
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Retrieve the Release Image</strong></p>
<div class="literalblock">
<div class="content">
<pre>Fetch the OpenShift release image that will be used for extracting credentials requests:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```bash
RELEASE_IMAGE=$(openshift-install version | awk '/release image/ {print $3}')
echo $RELEASE_IMAGE
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Extract CredentialsRequests</strong></p>
<div class="literalblock">
<div class="content">
<pre>Extract the CredentialsRequests from the release image:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```bash
mkdir -p credrequests
oc adm release extract --credentials-requests --cloud=aws --to=credrequests $RELEASE_IMAGE
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Create STS Resources</strong></p>
<div class="literalblock">
<div class="content">
<pre>Use `ccoctl` to create the necessary STS resources based on the extracted credentials requests:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```bash
ccoctl aws create-all --credentials-requests-dir credrequests --name ${STS_SUFFIX} --region ${AWS_REGION} --create-private-s3-bucket
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Verify Directory Contents</strong></p>
<div class="literalblock">
<div class="content">
<pre>Ensure that the STS configuration files have been correctly generated by listing the contents of the `sts` directory:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```bash
ls -R /home/ec2-user/sts
```</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>By following these steps, you will have successfully configured AWS STS credentials, enabling secure access to AWS services from your OpenShift cluster. This setup is essential for managing identities and authorizing access to resources in a secure manner.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="install-openshift-aws-tools.html">Install OpenShift &amp; AWS Tools</a></span>
  <span class="next"><a href="prepare-install-directory.html">Prepare Install Directory</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
